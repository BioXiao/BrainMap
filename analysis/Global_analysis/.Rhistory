library(ggplot2)
#Genes
DEGeneListFile<-"DEgenes_lists_transpose.tab"
DEGeneLists<-read.table(DEGeneListFile,header=T,sep="\t",stringsAsFactors=F)
head(DEGeneLists)
DEGeneList<-melt(DEGeneList)
DEGeneList<-melt(DEGeneList)
library(reshape2)
DEGeneList<-melt(DEGeneList)
DEGeneLists<-melt(DEGeneLists)
head(DEGeneLists<-melt(DEGeneLists))
head(DEGeneLists)
DEGeneLists<-melt(DEGeneLists)
head(DEGeneLists)
tail(DEGeneLists)
as.list(DEGeneLists<-melt(DEGeneLists))
DEGeneLists<-read.table(DEGeneListFile,header=T,sep="\t",stringsAsFactors=F)
as.list(DEGeneLists)
DEGeneLists<-read.table(DEGeneListFile,header=T,sep="\t",stringsAsFactors=F,NA.string="")
DEGeneLists<-read.table(DEGeneListFile,header=T,sep="\t",stringsAsFactors=F,NAstring="")
?read.table
DEGeneLists<-read.table(DEGeneListFile,header=T,sep="\t",stringsAsFactors=F,na.string="")
as.list(DEGeneLists)
DEGenes<-as.list(DEGeneLists)
unique(DEGenes)
lapply(DEGenes, na.exclude) 
DEGenes<-lapply(DEGenes, function (x) x[!is.na(x)]) 
DEGenes
length(DEGenes)
lapply(DEGenes,length)
unlist(DEGenes, use.names=FALSE)
unique(unlist(DEGenes, use.names=FALSE))
unlist(DEGenes)
as.data.frame(unlist(DEGenes))
head(as.data.frame(unlist(DEGenes)))
names(DEGenes)
grepl("_adult_",names(DEGenes))
DEGenes[[grepl("_adult_",names(DEGenes))]]
DEGenes[grepl("_adult_",names(DEGenes))]
names(DEGenes)
#Adult
DEGenes_adult<-DEGenes[grepl("_adult_",names(DEGenes))]
#Embryonic
DEGenes_emb<-DEGenes[grepl("_embryo_",names(DEGenes))]
library(stringr)
str_split_fixed(pattern="_",string=names(DEGenes),n=2)[1]
str_split_fixed(pattern="_",string=names(DEGenes),n=2)[,1]
strains<-unique(str_split_fixed(pattern="_",string=names(DEGenes),n=2)[,1])
strains
names(DEGenes)
DEGenes_adult_all<-unique(unlist(DEGenes_adult,use.names=FALSE))
DEGenes_adult_all
DEGenes_emb<-DEGenes[grepl("_embryo_",names(DEGenes))]
DEGenes_emb_all<-unique(unlist(DEGenes_emb,use.names=FALSE))
DEGenes_emb_all
intersect(DEGenes_adult_all,DEGenes_emb_all)
library(VennDiagram)
draw.pairwise.venn(1207,687,160,category=c("Embryonic","Adult"),scaled=TRUE,euler.d=TRUE)
venn.diagram(1207,687,160,category=c("Embryonic","Adult"),scaled=TRUE)
?venn.diagram
venn.diagram(list("Embryonic"=DEGenes_emb_all,"Adult"=DEGenes_adult_all))
?venn.diagram
venn.diagram(list("Embryonic"=DEGenes_emb_all,"Adult"=DEGenes_adult_all),filename=NULL)
plot(venn.diagram(list("Embryonic"=DEGenes_emb_all,"Adult"=DEGenes_adult_all),filename=NULL))
?venn.diagram
draw.pairwise.venn(1207,687,160,category=c("Embryonic","Adult"),scaled=TRUE,euler.d=TRUE,fontfamily=rep("sans-serif",3),col=c("tomato","steelblue"),alpha=rep(0.5,2))
draw.pairwise.venn(1207,687,160,category=c("Embryonic","Adult"),scaled=TRUE,euler.d=TRUE,fontfamily=rep("sans-serif",3),fill=c("tomato","steelblue"),alpha=rep(0.5,2))
x11()
draw.pairwise.venn(1207,687,160,category=c("Embryonic","Adult"),scaled=TRUE,euler.d=TRUE,fontfamily=rep("sans-serif",3),fill=c("tomato","steelblue"),alpha=rep(0.5,2))
pdf("All_adult_vs_embryonic_genes_venn.pdf",width=4,height=4)
draw.pairwise.venn(length(DEGenes_emb_all),
length(DEGenes_adult_all),
length(intersect(DEGenes_emb_all,DEGenes_adult_all)),
category=c("E14.5","Adult"),
scaled=TRUE,
euler.d=TRUE,
fontfamily=rep("sans-serif",3),
cat.fontfamily = rep("sans-serif",2), 
fill=c("tomato","steelblue"),
alpha=rep(0.5,2)
)
dev.off()
pdf("All_adult_vs_embryonic_genes_venn.pdf",width=4,height=4)
draw.pairwise.venn(length(DEGenes_emb_all),
length(DEGenes_adult_all),
length(intersect(DEGenes_emb_all,DEGenes_adult_all)),
category=c("E14.5","Adult"),
scaled=TRUE,
euler.d=TRUE,
fontfamily=rep("sansserif",3),
cat.fontfamily = rep("sansserif",2), 
fill=c("tomato","steelblue"),
alpha=rep(0.5,2)
)
dev.off()
pdf("All_adult_vs_embryonic_genes_venn.pdf",width=4,height=4)
draw.pairwise.venn(length(DEGenes_emb_all),
length(DEGenes_adult_all),
length(intersect(DEGenes_emb_all,DEGenes_adult_all)),
category=c("E14.5","Adult"),
scaled=TRUE,
euler.d=TRUE,
fontfamily=rep("sans",3),
cat.fontfamily = rep("sans",2), 
fill=c("tomato","steelblue"),
alpha=rep(0.5,2)
)
dev.off()
pdf("All_adult_vs_embryonic_genes_venn.pdf",width=4,height=4)
draw.pairwise.venn(length(DEGenes_emb_all),
length(DEGenes_adult_all),
length(intersect(DEGenes_emb_all,DEGenes_adult_all)),
category=c("E14.5","Adult"),
scaled=TRUE,
euler.d=TRUE,
fontfamily=rep("sans",3),
cat.fontfamily = rep("sans",2), 
fill=c("tomato","steelblue"),
alpha=rep(0.5,2),
lwd=rep(0.5,2)
)
dev.off()
head(DEGenes_adult_all)
DEGenes_adult_all
DEGenes_adult
lapply(DEGenes_adult,length)
as.data.frame(lapply(DEGenes_adult,length))
as.data.frame(unlist(lapply(DEGenes_adult,length)))
colnames(DEGenes_length)<-c("length")
DEGenes_length<-as.data.frame(unlist(lapply(DEGenes_adult,length)))
colnames(DEGenes_length)<-c("length")
DEGenes_length
rownames(DEGene_length)<-str_split_fixed(pattern="_",string=rownames(DEGene_length),n=2)[,1]
rownames(DEGene_length)<-str_split_fixed(pattern="_",string=rownames(DEGenes_length),n=2)[,1]
rownames(DEGenes_length)<-str_split_fixed(pattern="_",string=rownames(DEGenes_length),n=2)[,1]
#Genes
DEGeneListFile<-"DEgenes_lists_transpose.tab"
DEGeneLists<-read.table(DEGeneListFile,header=T,sep="\t",stringsAsFactors=F,na.string="")
DEGenes<-as.list(DEGeneLists)
DEGenes<-lapply(DEGenes, function (x) x[!is.na(x)]) 
#Strain names
strains<-unique(str_split_fixed(pattern="_",string=names(DEGenes),n=2)[,1])
#Adult
DEGenes_adult<-DEGenes[grepl("_adult_",names(DEGenes))]
DEGenes_adult_all<-unique(unlist(DEGenes_adult,use.names=FALSE))
DEGenes_length<-as.data.frame(unlist(lapply(DEGenes_adult,length)))
colnames(DEGenes_length)<-c("length")
rownames(DEGenes_length)<-str_split_fixed(pattern="_",string=rownames(DEGenes_length),n=2)[,1]
#Embryonic
DEGenes_emb<-DEGenes[grepl("_embryo_",names(DEGenes))]
DEGenes_emb_all<-unique(unlist(DEGenes_emb,use.names=FALSE))
#Adult vs Embryonic
pdf("All_adult_vs_embryonic_genes_venn.pdf",width=4,height=4)
draw.pairwise.venn(length(DEGenes_emb_all),
length(DEGenes_adult_all),
length(intersect(DEGenes_emb_all,DEGenes_adult_all)),
category=c("E14.5","Adult"),
scaled=TRUE,
euler.d=TRUE,
fontfamily=rep("sans",3),
cat.fontfamily = rep("sans",2), 
fill=c("tomato","steelblue"),
alpha=rep(0.5,2),
lwd=rep(0.5,2)
)
dev.off()
DEGenes_length
DEGenes_adult_length<-as.data.frame(unlist(lapply(DEGenes_adult,length)))
colnames(DEGenes_adult_length)<-c("length")
rownames(DEGenes_adult_length)<-str_split_fixed(pattern="_",string=rownames(DEGenes_adult_length),n=2)[,1]
DEGenes_adult_length
adult_cuff<-readCufflinks(dir="../Adult_full/")
embryonic_cuff<-readCufflinks(dir="../Embryonic_full/")
library(cummeRbund)
adult_cuff<-readCufflinks(dir="../Adult_full/")
embryonic_cuff<-readCufflinks(dir="../Embryonic_full/")
adult_cuff<-readCufflinks(dir="../Adult_full/")
adult_cuff
adult_cuff<-readCufflinks(dir="../../data/diffs/Adult_full/")
adult_cuff<-readCufflinks(dir="../../data/diffs/Adult_full/")
embryonic_cuff<-readCufflinks(dir="../../data/diffs/Embryonic_full/")
DEGenes_adult_all_genes<-getGenes(adult_cuff,DEGenes_adult_all)
DEGenes_adult_all_genes
DEGenes_adult_all
DEGenes_adult_all_genes
samples(DEGenes_adult_all_genes)
pdf("Degenes_adult_heatmap.pdf",width=10,height=15)
csFoldChangeHeatmap(DEGenes_adult_all_genes,cluster="row",labRow=F,control_condition="WT")
dev.off()
pdf("Degenes_adult_heatmap.pdf",width=10,height=15)
csFoldChangeHeatmap(DEGenes_adult_all_genes,cluster="row",labRow=F,control_condition="WT",method=dist)
dev.off()
pdf("Degenes_adult_heatmap.pdf",width=10,height=15)
csFoldChangeHeatmap(DEGenes_adult_all_genes,cluster="row",labRow=F,control_condition="WT",method=JSdist)
csFoldChangeHeatmap(DEGenes_adult_all_genes,cluster="row",labRow=F,control_condition="WT",method=function(x){JSdist(t(x))})
dev.off()
pdf("Degenes_adult_heatmap.pdf",width=10,height=15)
csFoldChangeHeatmap(DEGenes_adult_all_genes,cluster="row",labRow=F,control_condition="WT",method=dist)
dev.off()
pdf("Degenes_adult_heatmap.pdf",width=10,height=15)
csFoldChangeHeatmap(DEGenes_adult_all_genes,cluster="both",labRow=F,control_condition="WT",method=dist)
dev.off()
pdf("DEGenes_adult_dendro.pdf",width=10,height=5)
csDendro(DEGenes_adult_all_genes)
dev.off()
DEGenes_adult_length
p<-ggplot(DEGenes_adult_length)
DEGenes_adult_length$name<-rownames(DEGenes_adult_length)
p<-ggplot(DEGenes_adult_length)
p + geom_tile(aes(x=name,y=1,fill=length)) + scale_fill_gradient(limits=c(0,500),low="white",high="steelblue")
p <- ggplot(DEGenes_adult_length)
p <- p + geom_tile(aes(x=name,y=1,fill=length),line="black") + scale_fill_gradient(limits=c(0,500),low="white",high="steelblue") + theme_bw() + coord_equal(1)
pdf("DEGenes_adult_length_tile.pdf",width=10,height=3)
p
dev.off()
order.dendrogram(csDendro(DEGenes_adult_all_genes))
unique(samples(DEGenes_adult_all_genes))
x<-csDendro(DEGenes_adult_all_genes)
x
str(x)
labels(x)
order.dendrogram(x)
fpkmMatrix(DEGenes_adult_all_genes)
colnames(fpkmMatrix(DEGenes_adult_all_genes))
p <- ggplot(DEGenes_adult_length)
p <- p + geom_tile(aes(x=name,y=1,fill=length),line="black") + geom_text(aes(x=name,y=1,label=length)+ scale_fill_gradient(limits=c(0,500),low="white",high="steelblue") + theme_bw() + coord_equal(1)
pdf("DEGenes_adult_length_tile.pdf",width=10,height=3)
p
dev.off()
p <- ggplot(DEGenes_adult_length)
p <- p + geom_tile(aes(x=name,y=1,fill=length),line="black") + geom_text(aes(x=name,y=1,label=length))+ scale_fill_gradient(limits=c(0,500),low="white",high="steelblue") + theme_bw() + coord_equal(1)
pdf("DEGenes_adult_length_tile.pdf",width=10,height=3)
p
dev.off()
DEGenes_emb<-DEGenes[grepl("_embryo_",names(DEGenes))]
DEGenes_emb_all<-unique(unlist(DEGenes_emb,use.names=FALSE))
### Lengths
DEGenes_emb_length<-as.data.frame(unlist(lapply(DEGenes_emb,length)))
colnames(DEGenes_emb_length)<-c("length")
rownames(DEGenes_emb_length)<-str_split_fixed(pattern="_",string=rownames(DEGenes_emb_length),n=2)[,1]
DEGenes_emb_length$name<-rownames(DEGenes_emb_length)
p <- ggplot(DEGenes_emb_length)
p <- p + geom_tile(aes(x=name,y=1,fill=length),line="black") + geom_text(aes(x=name,y=1,label=length))+ scale_fill_gradient(limits=c(0,500),low="white",high="steelblue") + theme_bw() + coord_equal(1)
pdf("DEGenes_emb_length_tile.pdf",width=10,height=3)
p
dev.off()
### Gene Set
DEGenes_emb_all_genes<-getGenes(adult_cuff,DEGenes_emb_all)
DEGenes_emb_all_genes<-getGenes(embryonic_cuff,DEGenes_emb_all)
pdf("Degenes_emb_heatmap.pdf",width=10,height=15)
csFoldChangeHeatmap(DEGenes_emb_all_genes,cluster="both",labRow=F,control_condition="WT")
dev.off()
pdf("DEGenes_emb_dendro.pdf",width=10,height=5)
csDendro(DEGenes_emb_all_genes)
dev.off()
quit()
